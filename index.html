<!DOCTYPE html> 
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Valor de p: Tamanho Amostral vs Tamanho do Efeito</title>
    <meta name="description" content="Explore interativamente como o valor de p √© influenciado pelo tamanho amostral e pelo tamanho do efeito">
    <meta name="author" content="Marcelo">
    
    <!-- Open Graph para LinkedIn -->
    <meta property="og:title" content="Valor de p: Tamanho Amostral vs Tamanho do Efeito">
    <meta property="og:description" content="Ferramenta interativa para entender a rela√ß√£o entre n, tamanho do efeito e signific√¢ncia estat√≠stica">
    <meta property="og:type" content="website">
    
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        * { box-sizing: border-box; }
        body { margin: 0; font-family: system-ui, -apple-system, sans-serif; }
        
        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            height: 8px;
            border-radius: 4px;
            outline: none;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: currentColor;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: currentColor;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .slider-blue { background: #bfdbfe; color: #2563eb; }
        .slider-green { background: #a7f3d0; color: #059669; }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useMemo } = React;

        // Fun√ß√µes estat√≠sticas
        function normalPDF(x, mean, sd) {
            const coefficient = 1 / (sd * Math.sqrt(2 * Math.PI));
            const exponent = -0.5 * Math.pow((x - mean) / sd, 2);
            return coefficient * Math.exp(exponent);
        }

        function erf(x) {
            const a1 =  0.254829592;
            const a2 = -0.284496736;
            const a3 =  1.421413741;
            const a4 = -1.453152027;
            const a5 =  1.061405429;
            const p  =  0.3275911;
            const sign = x < 0 ? -1 : 1;
            x = Math.abs(x);
            const t = 1.0 / (1.0 + p * x);
            const y = 1.0 - (((((a5 * t + a4) * t) + a3) * t + a2) * t + a1) * t * Math.exp(-x * x);
            return sign * y;
        }

        function normalCDF(x, mean = 0, sd = 1) {
            return 0.5 * (1 + erf((x - mean) / (sd * Math.sqrt(2))));
        }

        function tCDF(t, df) {
            const x = df / (df + t * t);
            const a = df / 2;
            const b = 0.5;
            
            if (t === 0) return 0.5;
            if (df > 100) return normalCDF(t);
            
            const betaIncomplete = incompleteBeta(x, a, b);
            const result = 1 - 0.5 * betaIncomplete;
            
            return t > 0 ? result : 1 - result;
        }

        function incompleteBeta(x, a, b) {
            if (x === 0) return 0;
            if (x === 1) return 1;
            
            const bt = Math.exp(
                logGamma(a + b) - logGamma(a) - logGamma(b) +
                a * Math.log(x) + b * Math.log(1 - x)
            );
            
            if (x < (a + 1) / (a + b + 2)) {
                return bt * betaCF(x, a, b) / a;
            } else {
                return 1 - bt * betaCF(1 - x, b, a) / b;
            }
        }

        function betaCF(x, a, b) {
            const maxIterations = 100;
            const epsilon = 1e-10;
            
            let qab = a + b;
            let qap = a + 1;
            let qam = a - 1;
            let c = 1;
            let d = 1 - qab * x / qap;
            if (Math.abs(d) < epsilon) d = epsilon;
            d = 1 / d;
            let h = d;
            
            for (let m = 1; m <= maxIterations; m++) {
                let m2 = 2 * m;
                let aa = m * (b - m) * x / ((qam + m2) * (a + m2));
                d = 1 + aa * d;
                if (Math.abs(d) < epsilon) d = epsilon;
                c = 1 + aa / c;
                if (Math.abs(c) < epsilon) c = epsilon;
                d = 1 / d;
                h *= d * c;
                aa = -(a + m) * (qab + m) * x / ((a + m2) * (qap + m2));
                d = 1 + aa * d;
                if (Math.abs(d) < epsilon) d = epsilon;
                c = 1 + aa / c;
                if (Math.abs(c) < epsilon) c = epsilon;
                d = 1 / d;
                let del = d * c;
                h *= del;
                if (Math.abs(del - 1) < epsilon) break;
            }
            return h;
        }

        function logGamma(x) {
            const coefficients = [
                76.18009172947146, -86.50532032941677, 24.01409824083091,
                -1.231739572450155, 0.1208650973866179e-2, -0.5395239384953e-5
            ];
            
            let y = x;
            let tmp = x + 5.5;
            tmp -= (x + 0.5) * Math.log(tmp);
            let ser = 1.000000000190015;
            
            for (let j = 0; j < 6; j++) {
                ser += coefficients[j] / ++y;
            }
            
            return -tmp + Math.log(2.5066282746310005 * ser / x);
        }

        function calculateTTest(n1, n2, mean1, mean2, sd) {
            const pooledSE = sd * Math.sqrt(1/n1 + 1/n2);
            const tStat = (mean1 - mean2) / pooledSE;
            const df = n1 + n2 - 2;
            const pValue = 2 * (1 - tCDF(Math.abs(tStat), df));
            return { tStat, df, pValue: Math.max(0, Math.min(1, pValue)) };
        }

        function calculatePower(n, effectSize, alpha = 0.05) {
            const se = Math.sqrt(2 / n);
            const ncp = effectSize / se;
            const criticalZ = 1.96;
            const power = 1 - normalCDF(criticalZ - ncp) + normalCDF(-criticalZ - ncp);
            return Math.max(0, Math.min(1, power));
        }

        function PValueDemo() {
            const [sampleSize, setSampleSize] = useState(30);
            const [effectSize, setEffectSize] = useState(0.5);
            
            const sd = 1;
            const mean1 = 0;
            const mean2 = effectSize * sd;
            
            const stats = useMemo(() => {
                const result = calculateTTest(sampleSize, sampleSize, mean1, mean2, sd);
                const power = calculatePower(sampleSize, effectSize);
                return { ...result, power };
            }, [sampleSize, effectSize, mean1, mean2, sd]);
            
            const curvePoints = useMemo(() => {
                const points1 = [];
                const points2 = [];
                const seOfMean = sd / Math.sqrt(sampleSize);
                
                const minX = Math.min(mean1, mean2) - 4 * seOfMean;
                const maxX = Math.max(mean1, mean2) + 4 * seOfMean;
                
                for (let i = 0; i <= 200; i++) {
                    const x = minX + (maxX - minX) * (i / 200);
                    points1.push({ x, y: normalPDF(x, mean1, seOfMean) });
                    points2.push({ x, y: normalPDF(x, mean2, seOfMean) });
                }
                
                return { points1, points2, minX, maxX, seOfMean };
            }, [sampleSize, mean1, mean2, sd]);
            
            const { points1, points2, minX, maxX, seOfMean } = curvePoints;
            
            const svgWidth = 600;
            const svgHeight = 300;
            const padding = { top: 20, right: 30, bottom: 50, left: 50 };
            const plotWidth = svgWidth - padding.left - padding.right;
            const plotHeight = svgHeight - padding.top - padding.bottom;
            
            const maxY = Math.max(...points1.map(p => p.y), ...points2.map(p => p.y));
            
            const scaleX = (x) => padding.left + ((x - minX) / (maxX - minX)) * plotWidth;
            const scaleY = (y) => padding.top + plotHeight - (y / maxY) * plotHeight;
            
            const pathD1 = points1.map((p, i) => 
                `${i === 0 ? 'M' : 'L'} ${scaleX(p.x)} ${scaleY(p.y)}`
            ).join(' ');
            
            const pathD2 = points2.map((p, i) => 
                `${i === 0 ? 'M' : 'L'} ${scaleX(p.x)} ${scaleY(p.y)}`
            ).join(' ');
            
            const areaD1 = pathD1 + ` L ${scaleX(maxX)} ${scaleY(0)} L ${scaleX(minX)} ${scaleY(0)} Z`;
            const areaD2 = pathD2 + ` L ${scaleX(maxX)} ${scaleY(0)} L ${scaleX(minX)} ${scaleY(0)} Z`;
            
            const getPValueColor = (p) => {
                if (p < 0.001) return '#059669';
                if (p < 0.01) return '#10b981';
                if (p < 0.05) return '#f59e0b';
                return '#ef4444';
            };
            
            const getPValueLabel = (p) => {
                if (p < 0.001) return 'Altamente significativo';
                if (p < 0.01) return 'Muito significativo';
                if (p < 0.05) return 'Significativo';
                return 'N√£o significativo';
            };
            
            const getEffectLabel = (d) => {
                if (Math.abs(d) < 0.2) return 'Negligenci√°vel';
                if (Math.abs(d) < 0.5) return 'Pequeno';
                if (Math.abs(d) < 0.8) return 'M√©dio';
                return 'Grande';
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 p-4 md:p-6">
                    <div className="max-w-4xl mx-auto">
                        <div className="text-center mb-6 md:mb-8">
                            <h1 className="text-2xl md:text-3xl font-bold text-slate-800 mb-2">
                                Valor de p: Tamanho Amostral vs Tamanho do Efeito
                            </h1>
                            <p className="text-slate-600 text-sm md:text-base">
                                Explore como o valor de p √© influenciado pelo n e pela magnitude do efeito
                            </p>
                        </div>
                        
                        {/* Controles */}
                        <div className="bg-white rounded-2xl shadow-lg p-4 md:p-6 mb-4 md:mb-6">
                            <div className="grid md:grid-cols-2 gap-6 md:gap-8">
                                <div>
                                    <label className="block text-sm font-semibold text-slate-700 mb-3">
                                        Tamanho da Amostra (n por grupo)
                                    </label>
                                    <input
                                        type="range"
                                        min="5"
                                        max="500"
                                        value={sampleSize}
                                        onChange={(e) => setSampleSize(Number(e.target.value))}
                                        className="w-full slider-blue cursor-pointer"
                                    />
                                    <div className="flex justify-between text-sm text-slate-500 mt-2">
                                        <span>5</span>
                                        <span className="font-bold text-blue-600 text-xl">{sampleSize}</span>
                                        <span>500</span>
                                    </div>
                                </div>
                                
                                <div>
                                    <label className="block text-sm font-semibold text-slate-700 mb-3">
                                        Tamanho do Efeito (Cohen's d)
                                    </label>
                                    <input
                                        type="range"
                                        min="0"
                                        max="2"
                                        step="0.05"
                                        value={effectSize}
                                        onChange={(e) => setEffectSize(Number(e.target.value))}
                                        className="w-full slider-green cursor-pointer"
                                    />
                                    <div className="flex justify-between text-sm text-slate-500 mt-2">
                                        <span>0</span>
                                        <span className="font-bold text-emerald-600 text-xl">
                                            {effectSize.toFixed(2)} <span className="text-sm font-normal">({getEffectLabel(effectSize)})</span>
                                        </span>
                                        <span>2</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        {/* Gr√°fico */}
                        <div className="bg-white rounded-2xl shadow-lg p-4 md:p-6 mb-4 md:mb-6">
                            <h2 className="text-base md:text-lg font-semibold text-slate-700 mb-4">
                                Distribui√ß√µes Amostrais das M√©dias
                            </h2>
                            <svg viewBox={`0 0 ${svgWidth} ${svgHeight}`} className="w-full">
                                {/* Eixos */}
                                <line 
                                    x1={padding.left} y1={scaleY(0)} 
                                    x2={svgWidth - padding.right} y2={scaleY(0)} 
                                    stroke="#94a3b8" strokeWidth="1"
                                />
                                <line 
                                    x1={padding.left} y1={padding.top} 
                                    x2={padding.left} y2={scaleY(0)} 
                                    stroke="#94a3b8" strokeWidth="1"
                                />
                                
                                {/* Linhas de refer√™ncia */}
                                <line 
                                    x1={scaleX(mean1)} y1={padding.top} 
                                    x2={scaleX(mean1)} y2={scaleY(0)} 
                                    stroke="#3b82f6" strokeWidth="1" strokeDasharray="4,4" opacity="0.5"
                                />
                                <line 
                                    x1={scaleX(mean2)} y1={padding.top} 
                                    x2={scaleX(mean2)} y2={scaleY(0)} 
                                    stroke="#10b981" strokeWidth="1" strokeDasharray="4,4" opacity="0.5"
                                />
                                
                                {/* √Åreas */}
                                <path d={areaD1} fill="#3b82f6" opacity="0.2" />
                                <path d={areaD2} fill="#10b981" opacity="0.2" />
                                
                                {/* Curvas */}
                                <path d={pathD1} fill="none" stroke="#3b82f6" strokeWidth="3" />
                                <path d={pathD2} fill="none" stroke="#10b981" strokeWidth="3" />
                                
                                {/* Labels */}
                                <text x={svgWidth / 2} y={svgHeight - 10} textAnchor="middle" className="text-sm" fill="#64748b">
                                    M√©dia amostral
                                </text>
                                
                                {/* Legenda */}
                                <rect x={svgWidth - 160} y={20} width="12" height="12" fill="#3b82f6" rx="2" />
                                <text x={svgWidth - 142} y={30} fontSize="12" fill="#64748b">Grupo 1 (Œº = 0)</text>
                                <rect x={svgWidth - 160} y={40} width="12" height="12" fill="#10b981" rx="2" />
                                <text x={svgWidth - 142} y={50} fontSize="12" fill="#64748b">Grupo 2 (Œº = {mean2.toFixed(2)})</text>
                            </svg>
                            <p className="text-sm text-slate-500 mt-2 text-center">
                                Erro padr√£o da m√©dia = {seOfMean.toFixed(3)} (œÉ/‚àön)
                            </p>
                        </div>
                        
                        {/* Resultados */}
                        <div className="grid grid-cols-3 gap-2 md:gap-4 mb-4 md:mb-6">
                            <div className="bg-white rounded-xl md:rounded-2xl shadow-lg p-3 md:p-6 text-center">
                                <div className="text-xs md:text-sm text-slate-500 mb-1">Valor de p</div>
                                <div 
                                    className="text-xl md:text-4xl font-bold"
                                    style={{ color: getPValueColor(stats.pValue) }}
                                >
                                    {stats.pValue < 0.0001 ? '<.0001' : stats.pValue.toFixed(4)}
                                </div>
                                <div 
                                    className="text-xs md:text-sm font-medium mt-1"
                                    style={{ color: getPValueColor(stats.pValue) }}
                                >
                                    {getPValueLabel(stats.pValue)}
                                </div>
                            </div>
                            
                            <div className="bg-white rounded-xl md:rounded-2xl shadow-lg p-3 md:p-6 text-center">
                                <div className="text-xs md:text-sm text-slate-500 mb-1">Estat√≠stica t</div>
                                <div className="text-xl md:text-4xl font-bold text-slate-700">
                                    {stats.tStat.toFixed(2)}
                                </div>
                                <div className="text-xs md:text-sm text-slate-500 mt-1">
                                    gl = {stats.df}
                                </div>
                            </div>
                            
                            <div className="bg-white rounded-xl md:rounded-2xl shadow-lg p-3 md:p-6 text-center">
                                <div className="text-xs md:text-sm text-slate-500 mb-1">Poder</div>
                                <div className="text-xl md:text-4xl font-bold" style={{ 
                                    color: stats.power >= 0.8 ? '#059669' : stats.power >= 0.5 ? '#f59e0b' : '#ef4444' 
                                }}>
                                    {(stats.power * 100).toFixed(0)}%
                                </div>
                                <div className="text-xs md:text-sm text-slate-500 mt-1">
                                    {stats.power >= 0.8 ? '‚â•80% ‚úì' : '<80%'}
                                </div>
                            </div>
                        </div>
                        
                        {/* Interpreta√ß√£o */}
                        <div className="bg-gradient-to-r from-blue-50 to-emerald-50 rounded-2xl p-4 md:p-6">
                            <h3 className="font-semibold text-slate-700 mb-3">üí° Interpreta√ß√£o</h3>
                            <div className="space-y-2 text-sm text-slate-600">
                                <p>
                                    <strong>Efeito d = {effectSize.toFixed(2)}:</strong> Diferen√ßa de {effectSize.toFixed(2)} desvios-padr√£o 
                                    ‚Äî efeito <strong>{getEffectLabel(effectSize).toLowerCase()}</strong>.
                                </p>
                                <p>
                                    <strong>Com n = {sampleSize}:</strong> EP = {seOfMean.toFixed(3)}, 
                                    distribui√ß√µes {sampleSize > 100 ? 'estreitas' : sampleSize > 30 ? 'moderadas' : 'largas'}.
                                </p>
                                <p>
                                    <strong>Conclus√£o:</strong> {stats.pValue < 0.05 
                                        ? `p = ${stats.pValue < 0.0001 ? '< 0.0001' : stats.pValue.toFixed(4)} ‚Üí rejeitamos H‚ÇÄ. Mas signific√¢ncia estat√≠stica ‚â† relev√¢ncia cl√≠nica!`
                                        : `p = ${stats.pValue.toFixed(4)} ‚Üí n√£o rejeitamos H‚ÇÄ. Pode ser aus√™ncia de efeito OU poder insuficiente (${(stats.power * 100).toFixed(0)}%).`
                                    }
                                </p>
                            </div>
                        </div>
                        
                        <div className="mt-6 text-center text-xs text-slate-400">
                            Teste t para duas amostras independentes ¬∑ Vari√¢ncias iguais assumidas
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById('root')).render(<PValueDemo />);
    </script>
</body>
</html>
